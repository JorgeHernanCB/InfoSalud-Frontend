<div class="mt-3">
  <p-panel header="BUSCAR CONVENIO" toggleable="true">
    <form [formGroup]="conveniosForm" (ngSubmit)="onSubmit()">
      <app-filtered-button
        (onSearch)="onSearch()"
        (onClear)="clearForm()"
      ></app-filtered-button>

      <!-- Row 1 -->
      <div class="formgrid mt-5 grid custom-col-extend">
        <!-- Numero de convenio -->
        <div class="field custom-col">
          <p-floatLabel>
            <input
              formControlName="numberAgreement"
              pInputText
              id="numberAgreement"
              type="number"
            />
            <label
              htmlFor="float-label"
              id="custom-pfloatLabel"
              class="custom-w"
              >Numero de convenio
            </label>
          </p-floatLabel>
        </div>

        <!-- Tipo de convenio -->
        <div class="field custom-col">
          <p-floatLabel>
            <p-dropdown
              formControlName="typeAgreement"
              [options]="typeAgreements"
              optionLabel="typeAgreement"
              inputId="float-label"
              placeholder="Tipo de convenios"
            />
            <label for="float-label" id="custom-pfloatLabel" class="custom-w"
              >Tipo de convenio</label
            >
          </p-floatLabel>
        </div>

        <!-- Estado del convenio -->
        <div class="field custom-col">
          <p-floatLabel>
            <p-dropdown
              formControlName="statusAgreement"
              [options]="statusAgreements"
              optionLabel="statusAgreement"
              inputId="float-label"
              placeholder="Estado"
            />
            <label for="float-label" id="custom-pfloatLabel" class="custom-w"
              >Estado del convenio</label
            >
          </p-floatLabel>
        </div>

        <!-- Nombre del convenio -->
        <div class="field custom-col">
          <p-floatLabel>
            <input
              pInputText
              id="nameAgreement"
              type="text"
              formControlName="nameAgreement"
            />
            <label
              htmlFor="float-label"
              id="custom-pfloatLabel"
              class="custom-w"
              >Nombre de convenio
            </label>
          </p-floatLabel>
        </div>
      </div>

      <!-- Row 2 -->
      <div class="formgrid mt-3 grid custom-col-extend">
        <!-- NIT de proveedores -->
        <div class="field custom-col">
          <p-floatLabel>
            <input
              formControlName="nitProviders"
              pInputText
              id="nitProviders"
              type="number"
            />
            <label
              htmlFor="float-label"
              id="custom-pfloatLabel"
              class="custom-w"
              >NIT de proveedores
            </label>
          </p-floatLabel>
        </div>

        <!-- Razon social proveedor -->
        <div class="field custom-col">
          <p-floatLabel>
            <input
              pInputText
              formControlName="companyNameProviders"
              id="companyNameProviders"
              type="text"
            />
            <label
              htmlFor="float-label"
              id="custom-pfloatLabel"
              class="custom-w"
              >Raz&oacute;n social proveedor
            </label>
          </p-floatLabel>
        </div>

        <!-- Razon comercial proveedor -->
        <div class="field custom-col">
          <p-floatLabel>
            <input
              pInputText
              formControlName="businessNameProviders"
              id="businessNameProviders"
              type="text"
            />
            <label
              htmlFor="float-label"
              id="custom-pfloatLabel"
              class="custom-w"
              >Raz&oacute;n comercial proveedor
            </label>
          </p-floatLabel>
        </div>

        <!-- Codigo de proveedor -->
        <div class="field custom-col">
          <p-floatLabel>
            <input
              pInputText
              formControlName="codeProvider"
              id="codeProvider"
              type="number"
            />
            <label
              htmlFor="float-label"
              id="custom-pfloatLabel"
              class="custom-w"
              >Codigo de proveedor
            </label>
          </p-floatLabel>
        </div>
      </div>

      <!-- Row 3 -->
      <div class="formgrid grid mt-3 custom-col-extend">
        <!-- Fecha inicio -->
        <div class="field custom-col">
          <p-floatLabel>
            <p-calendar
              formControlName="dateStart"
              [showIcon]="true"
              inputId="icondisplay"
             [iconDisplay]="'input'"
            />
            <label
              htmlFor="float-label"
              id="custom-pfloatLabel"
              class="custom-w"
              >Fecha inicio vigencia
            </label>
          </p-floatLabel>
        </div>

        <!-- Fecha vigencia final -->
        <div class="field custom-col">
          <div class="flex-auto">
            <p-floatLabel>
              <p-calendar
                formControlName="dateFinish"
                [showIcon]="true"
                inputId="icondisplay"
               [iconDisplay]="'input'"
              />
              <label
                htmlFor="float-label"
                id="custom-pfloatLabel"
                class="custom-w"
                >Fecha vigencia final
              </label>
            </p-floatLabel>
          </div>
        </div>

        <!-- Ramo -->
        <div class="field custom-col">
          <div class="flex-auto">
            <p-floatLabel>
              <p-dropdown
                formControlName="ramo"
                [options]="ramos"
                optionLabel="ramo"
                placeholder="Ramo"
              />
              <label
                htmlFor="float-label"
                id="custom-pfloatLabel"
                class="custom-w"
                >Ramo</label
              >
            </p-floatLabel>
          </div>
        </div>

        <!-- Productos -->
        <div class="field custom-col">
          <p-floatLabel>
            <p-dropdown
              formControlName="product"
              [options]="products"
              optionLabel="product"
              inputId="float-label"
              placeholder="Productos"
            />
            <label for="float-label" id="custom-pfloatLabel" class="custom-w"
              >Productos</label
            >
          </p-floatLabel>
        </div>
      </div>

      <!-- Row 4 -->
      <div class="formgrid grid mt-3 custom-col-extend">
        <!-- Renovacion automatica -->
        <div class="field custom-col">
          <p-floatLabel>
            <p-dropdown
              [options]="automaticRenewals"
              formControlName="automaticRenewal"
              optionLabel="automaticRenewal"
              placeholder="Renovaci&oacute;n autom&aacute;tica"
            />
            <label
              htmlFor="float-label"
              id="custom-pfloatLabel"
              class="custom-w"
              >Renovación Automática</label
            >
          </p-floatLabel>
        </div>

        <!-- Departamento -->
        <div class="field custom-col">
          <div class="flex-auto">
            <p-floatLabel>
              <p-dropdown
                [options]="departaments"
                formControlName="departament"
                optionLabel="departament"
                inputId="float-label"
                placeholder="Departamento"
              />
              <label
                htmlFor="float-label"
                id="custom-pfloatLabel"
                class="custom-w"
                >Departamento</label
              >
            </p-floatLabel>
          </div>
        </div>

        <!-- Ciudad/Municipio -->
        <div class="field custom-col">
          <div class="flex-auto">
            <p-floatLabel>
              <p-dropdown
                [options]="cities"
                formControlName="city"
                optionLabel="city"
                inputId="float-label"
                placeholder="Ciudad / Municipio"
              />
              <label
                htmlFor="float-label"
                id="custom-pfloatLabel"
                class="custom-w"
                >Ciudad / Municipio</label
              >
            </p-floatLabel>
          </div>
        </div>

        <!-- Usuario -->
        <div class="field custom-col">
          <p-floatLabel>
            <input
              formControlName="user"
              pInputText
              id="user"
              class="ipt-disabled"
              type="text"
            />
            <label
              htmlFor="float-label"
              id="custom-pfloatLabel"
              class="custom-w"
              >Usuario
            </label>
          </p-floatLabel>
        </div>
      </div>
    </form>
  </p-panel>

  <!--Table-->
  <div class="mt-4">
    <p-panel header="CONVENIOS ENCONTRADOS" toggleable="true">
      <p-table
        #dt1
        [value]="convenios"
        [paginator]="true"
        [rows]="10"
        [rowsPerPageOptions]="[5, 10, 20, 100]"
        styleClass="p-datatable-gridlines p-datatable-sm"
        [tableStyle]="{ 'min-width': '45rem' }"
        [globalFilterFields]="[
          'numberAgreement',
          'typeAgreement',
          'nameAgreement',
          'product',
          'dateStart',
          'dateFinish ',
          'statusAgreement',
          'activeRate'
        ]"
        [rowHover]="true"
        dataKey="id"
        currentPageReportTemplate="Mostrando del {first} al {last} de {totalRecords} datos"
        [showCurrentPageReport]="true"
        emptyMessage="No hay datos"
      >
      <ng-template pTemplate="header">
        <tr>
          <!-- <th style="width: 4rem;">
            <p-tableHeaderCheckbox />
          </th> -->
          <th pSortableColumn="numberAgreement"
            class="text-center p-table-title"
            style="width: 100px;">
            Numero de convenio
            <p-sortIcon field="numberAgreement"></p-sortIcon>
          </th>
          <th
            pSortableColumn="typeAgreement"
            class="text-center p-table-title"
            style="width: 150px;">
            Tipo de convenio
            <p-sortIcon field="typeAgreement"></p-sortIcon>
          </th>
          <th
            pSortableColumn="nameAgreement"
            class="text-center p-table-title"
            style="width: 250px;">
            Nombre
            <p-sortIcon field="nameAgreement"></p-sortIcon>
          </th>
          <th
            pSortableColumn="product"
            class="text-center p-table-title"
            style="width: 150px;">
            Producto <p-sortIcon field="product"></p-sortIcon>
          </th>
          <th
            pSortableColumn="dateStart"
            class="text-center p-table-title"
            style="width: 100px;">
            Fecha vigente inicial <p-sortIcon field="dateStart"></p-sortIcon>
          </th>
          <th
            pSortableColumn="dateFinish"
            class="text-center p-table-title"
            style="width: 100px;">
            Fecha vigente final
            <p-sortIcon field="dateFinish"></p-sortIcon>
          </th>
          <th
            pSortableColumn="statusAgreement"
            class="text-center p-table-title"
            style="width: 100px;">
            Estado
            <p-sortIcon field="statusAgreement"></p-sortIcon>
          </th>
          <th
            pSortableColumn="activeRate"
            class="text-center p-table-title"
            style="width: 150px;">
            Tarifa activa <p-sortIcon field="activeRate"></p-sortIcon>
          </th>
          <th class="text-center p-table-title"
            style="width:50px">Acciones</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-convenios>
        <tr>
          <!-- <td>
            <p-tableCheckbox [value]="proveedor" />
          </td> -->

          <td class="text-center">{{ convenios.numberAgreement }}</td>
          <td class="text-center">{{ convenios.typeAgreement }}</td>
          <td class="text-center">{{ convenios.nameAgreement }}</td>
          <td class="text-center">{{ convenios.product }}</td>
          <td class="text-center">{{ convenios.dateStart }}</td>
          <td class="text-center">{{ convenios.dateFinish }}</td>
          <td class="text-center">{{ convenios.statusAgreement }}</td>
          <td class="text-center">{{ convenios.activeRate }}</td>
          <td class="text-center">
            <div class="flex justify-content-center align-items-center">
              <!-- (click)="editProveedor(proveedor)" -->
              <!-- (click)="showProveedor(proveedor)" -->
              <p-button
                icon="pi pi-search"
                [rounded]="true"
                [text]="true"
                pTooltip="Buscar"
                tooltipPosition="top"
                class="p-button-rounded flex-1"
                [state]="{ convenio: convenios, isViewMode: true }"
                [routerLink]="['/convenios/mostrar', convenios.id]"
              >
              </p-button>
              <!-- (click)="editProveedor(proveedor)" -->
              <p-button
                icon="pi pi-pencil"
                [rounded]="true"
                [text]="true"
                pTooltip="Editar"
                tooltipPosition="top"
                class="p-button-rounded flex-1"
                [state]="{ convenio: convenios, isViewMode: false }"
                [routerLink]="['/convenios/editar', convenios.id]"
              >
              </p-button>
            </div>
          </td>
        </tr>
      </ng-template>


      </p-table>
    </p-panel>
  </div>
</div>
